!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("history"),require("mobx")):"function"==typeof define&&define.amd?define(["exports","history","mobx"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MobxReactRouter={},e.HistoryLibrary,e.mobx)}(this,(function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var n=e[r];if("*"!==n&&"+"!==n&&"?"!==n)if("\\"!==n)if("{"!==n)if("}"!==n)if(":"!==n)if("("!==n)t.push({type:"CHAR",index:r,value:e[r++]});else{var i=1,a="";if("?"===e[s=r+1])throw new TypeError('Pattern cannot start with "?" at '+s);for(;s<e.length;)if("\\"!==e[s]){if(")"===e[s]){if(0==--i){s++;break}}else if("("===e[s]&&(i++,"?"!==e[s+1]))throw new TypeError("Capturing groups are not allowed at "+s);a+=e[s++]}else a+=e[s++]+e[s++];if(i)throw new TypeError("Unbalanced pattern at "+r);if(!a)throw new TypeError("Missing pattern at "+r);t.push({type:"PATTERN",index:r,value:a}),r=s}else{for(var o="",s=r+1;s<e.length;){var u=e.charCodeAt(s);if(!(u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||95===u))break;o+=e[s++]}if(!o)throw new TypeError("Missing parameter name at "+r);t.push({type:"NAME",index:r,value:o}),r=s}else t.push({type:"CLOSE",index:r,value:e[r++]});else t.push({type:"OPEN",index:r,value:e[r++]});else t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});else t.push({type:"MODIFIER",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),n=t.prefixes,i=void 0===n?"./":n,a="[^"+f(t.delimiter||"/#?")+"]+?",o=[],s=0,u=0,c="",p=function(e){if(u<r.length&&r[u].type===e)return r[u++].value},h=function(e){var t=p(e);if(void 0!==t)return t;var n=r[u],i=n.type,a=n.index;throw new TypeError("Unexpected "+i+" at "+a+", expected "+e)},l=function(){for(var e,t="";e=p("CHAR")||p("ESCAPED_CHAR");)t+=e;return t};u<r.length;){var d=p("CHAR"),v=p("NAME"),y=p("PATTERN");if(v||y){var b=d||"";-1===i.indexOf(b)&&(c+=b,b=""),c&&(o.push(c),c=""),o.push({name:v||s++,prefix:b,suffix:"",pattern:y||a,modifier:p("MODIFIER")||""})}else{var m=d||p("ESCAPED_CHAR");if(m)c+=m;else if(c&&(o.push(c),c=""),p("OPEN")){b=l();var g=p("NAME")||"",x=p("PATTERN")||"",P=l();h("CLOSE"),o.push({name:g||(x?s++:""),pattern:g&&!x?a:x,prefix:b,suffix:P,modifier:p("MODIFIER")||""})}else h("END")}}return o}function u(e,t){var r=[];return function(e,t,r){void 0===r&&(r={});var n=r.decode,i=void 0===n?function(e){return e}:n;return function(r){var n=e.exec(r);if(!n)return!1;for(var a=n[0],o=n.index,s=Object.create(null),u=function(e){if(void 0===n[e])return"continue";var r=t[e-1];"*"===r.modifier||"+"===r.modifier?s[r.name]=n[e].split(r.prefix+r.suffix).map((function(e){return i(e,r)})):s[r.name]=i(n[e],r)},f=1;f<n.length;f++)u(f);return{path:a,index:o,params:s}}}(h(e,r,t),r,t)}function f(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function c(e){return e&&e.sensitive?"":"i"}function p(e,t,r){return function(e,t,r){void 0===r&&(r={});for(var n=r.strict,i=void 0!==n&&n,a=r.start,o=void 0===a||a,s=r.end,u=void 0===s||s,p=r.encode,h=void 0===p?function(e){return e}:p,l="["+f(r.endsWith||"")+"]|$",d="["+f(r.delimiter||"/#?")+"]",v=o?"^":"",y=0,b=e;y<b.length;y++){var m=b[y];if("string"==typeof m)v+=f(h(m));else{var g=f(h(m.prefix)),x=f(h(m.suffix));if(m.pattern)if(t&&t.push(m),g||x)if("+"===m.modifier||"*"===m.modifier){var P="*"===m.modifier?"?":"";v+="(?:"+g+"((?:"+m.pattern+")(?:"+x+g+"(?:"+m.pattern+"))*)"+x+")"+P}else v+="(?:"+g+"("+m.pattern+")"+x+")"+m.modifier;else v+="("+m.pattern+")"+m.modifier;else v+="(?:"+g+x+")"+m.modifier}}if(u)i||(v+=d+"?"),v+=r.endsWith?"(?="+l+")":"$";else{var E=e[e.length-1],w="string"==typeof E?d.indexOf(E[E.length-1])>-1:void 0===E;i||(v+="(?:"+d+"(?="+l+"))?"),w||(v+="(?="+d+"|"+l+")")}return new RegExp(v,c(r))}(s(e,r),t,r)}function h(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,n=0,i=r.exec(e.source);i;)t.push({name:i[1]||n++,prefix:"",suffix:"",modifier:"",pattern:""}),i=r.exec(e.source);return e}(e,t):Array.isArray(e)?function(e,t,r){var n=e.map((function(e){return h(e,t,r).source}));return new RegExp("(?:"+n.join("|")+")",c(r))}(e,t,r):p(e,t,r)}var l=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t){return"".concat(e.replace(/\/$/,""),"/").concat(t.replace(/^\//,""))}))},d=function(){function e(n,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.history=n,this.basePath=i,this.pathList=[],this.state={action:t.Action.Pop,location:{key:"default",pathname:"",search:"",state:{},hash:""}},this.go=void 0,this.back=void 0,this.forward=void 0,this.updateState=r.action((function(e){var t=o.basePath?e.location.pathname.replace(o.basePath,""):e.location.pathname;""===t&&(t="/"),o.state={action:e.action,location:a(a({},e.location),{},{pathname:t})}})),this.subscribe=void 0,this.stopSyncWithHistory=void 0,this.go=n.go.bind(n),this.back=n.back.bind(n),this.forward=n.forward.bind(n),r.makeObservable(this,{state:r.observable,location:r.computed,query:r.computed,pathList:r.observable,hashValue:r.computed,pathValue:r.computed,appendPathList:r.action,prependPathList:r.action}),this.subscribe=function(e){var t=n.listen(e);return e({action:n.action,location:n.location}),t},this.stopSyncWithHistory=this.subscribe(this.updateState)}var n,i,s;return n=e,i=[{key:"location",get:function(){return this.state.location}},{key:"push",value:function(e,t){this.history.push(this.addBasename(e),t)}},{key:"replace",value:function(e,t){this.history.replace(this.addBasename(e),t)}},{key:"query",get:function(){var e=this.location.search,t={};return e&&new URLSearchParams(e).forEach((function(e,r){t[r]?Array.isArray(t[r])?t[r].push(e):t[r]=[t[r],e]:t[r]=e})),t}},{key:"hashValue",get:function(){var e=this.location.hash;return e?e.slice(1):""}},{key:"pathValue",get:function(){var e=this.location.pathname,t={},r=!1;return this.pathList.find((function(n){var i=u(n,{decode:decodeURIComponent})(e);return i&&i&&(t=i.params,r=!0),r})),t}},{key:"appendPathList",value:function(){var e;(e=this.pathList).push.apply(e,arguments)}},{key:"prependPathList",value:function(){var e;(e=this.pathList).unshift.apply(e,arguments)}},{key:"addBasename",value:function(e){if(!this.basePath)return e;if("string"==typeof e){if(!e.startsWith(this.basePath))return l(this.basePath,e)}else e.pathname&&!e.pathname.startsWith(this.basePath)&&(e.pathname=l(this.basePath,e.pathname));return e}}],i&&o(n.prototype,i),s&&o(n,s),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.RouterStore=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=mobx-react-router.min.js.map
